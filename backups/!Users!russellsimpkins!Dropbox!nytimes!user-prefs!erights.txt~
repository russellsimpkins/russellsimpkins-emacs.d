#Erights database user in DEV
erights27
sthg1r3

^I.P^Port^SID^login^password^
||1522|r2dv2|erights27|stg1r3|

====Crib Notes====
During my conversation with Peter, I caught this:
  * erights resources - everything is a resource
  * products are collections of resources
  * policies - someone has access to a product
  * offer can have multiple fulfilments
  * fulfilment templates to re-use a fulfilment process

To create an offer; you add fulfiments and produts and policies
Users subscribe to offer chains

^Environment^IP/Name^Login^Password
|Development|10.5.103.38|erights|gran1tar|

====Logging Environment====
The erights system supports a telnet interface

<code bash>telnet 0 8833</code>
password: d0gn0tcat

type logger : that will put you into the loggers
setlevel * 0 7 (0 = lowest 7 = max)

logs live here:
<code>/erights/erights-2.7.1/erightss/logs</code>

ERights URL
https://select-sys.prvt.nytimes.com/commerce/jsp/

https://select-sys.prvt.nytimes.com/commerce/jsp/trans_history.jsp
https://select-sys.prvt.nytimes.com/commerce/jsp/purchase_history.jsp
https://select-sys.prvt.nytimes.com/commerce/jsp/register.jsp

===Information We need===
customer info
billing info
purchase history
maybe we need to get more of it -

narocite/order 322136


====Chase Paymentech Orbital Gateway====

Chase's documentation:
  * [[http://download.chasepaymentech.com/portal/server.pt/gateway/PTARGS_0_226_1595_0_0_18/Orbital_Gateway_XML_Specification.pdf|Gateway
XML Specification]]
  * [[http://download.chasepaymentech.com|Chase SDK]]

the stuff on profiles is most useful

====Financial API====
The financial API will essentially be our gateway to talk to Chase. 
[[http://wiki.em.nytimes.com/dev/doku.php?id=user_prefs:sad:e-commerce:financial-api|Financial
API]]

===Key Features===
  - Authorize new credit cards
  - Perform settlement transactions

===Dependencies===
  - All existing customer credit cards **must** be imported into our
  Chase account for **PCI** compliance


====SVN Locations====
  - [[https://svn.prvt.nytimes.com/svn/sartre/financial-api|financial-api]]
  - [[https://svn.prvt.nytimes.com/svn/sartre/financial-api/branches/initial-dev|
  initial dev branch]]

**NOTE** early, rudimentary stubs created through 5/25/10 are in svn
here [[https://svn.prvt.nytimes.com/svn/sartre/financial-api/branches/initial-dev|initial-dev]].  

Feel free to branch from there if you'd like.  The ProfileResource should correspond to the payment profile stuff I mentioned
I'll be fleshing out the TransactionResource
let me know if you have any questions.
Are you familiar with JAX-RS and jersey?


====Erights SQL====
===Identify all Credit Cards that can be purged===
<code sql>
select 
  fi.id, 
  ba.id, 
  ba.customer_id, 
  cc.masked_cardnum
from  
  billfininstrument fi, 
  nytd_cc cc, 
  billaccount ba 
where 
 cc.id = fi.id
 and (cc.exp_yr < 2010 or (cc.exp_yr = 2010 and exp_mo < 5))
 and fi.account_id = ba.id
 and ba.customer_id 
 not in
 (select customer_id from erightssubscriptions where date_terminated is null and chain_id in (1,2))
</code>
